<!DOCTYPE html>

{% load staticfiles %}
<html lang="en">


<!-- Mirrored from www.wrappixel.com/demos/admin-templates/material-pro/dark/index.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 06 May 2020 12:26:28 GMT -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- Tell the browser to be responsive to screen width -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <!-- Favicon icon -->
    <!-- <link rel="icon" type="image/png" sizes="16x16" href="https://www.wrappixel.com/demos/admin-templates/material-pro/assets/images/favicon.png"> -->
    <title>Session Handler</title>


     <!-- <link rel="stylesheet" href="{% static "css/bootstrap.min.css" %}" type="text/css" />  -->

      <script src="{% static "js/jquery-2.2.4.min.js" %}" type="text/javascript"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.3.3/js/tether.min.js" type="text/javascript"></script>
      <script src="{% static "js/bootstrap.min.js" %}" type="text/javascript"></script>
      <script src="{% static "js/reconnecting-websocket.min.js" %}" type="text/javascript"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>






    <link href="{% static "css/stl2.css" %}" rel="stylesheet">
    <link href="{% static "css/colors/green-dark.css" %}" rel="stylesheet">


<style type="text/css">
    
#bck{

background-image: url("{% static 'a.png' %}"),url("{% static 'b.jpeg' %}");
  background-attachment: fixed;
  /*color:white;*/
  /*background-repeat: no-repeat;*/
background-position: center ;
}

</style>


</head>





<body class="fix-header fix-sidebar card-no-border" cz-shortcut-listen="true">







    <div id="main-wrapper">

        <header class="topbar">
            <nav class="">

                <div class="top-navbar navbar navbar-header" style="background: #db9a1aeb;"><!-- ffb22b -->
                    <a class="navbar-brand" href="index.html" style="margin-left:5px;">
                        <!-- Logo icon --><b>
                            <!--You can put here icon as well // <i class="wi wi-sunset"></i> //-->
                            <!-- Dark Logo icon -->

                            <!-- Light Logo icon -->
                            <img src="/static/logo.png" width="50px">
                            </b>
                            <!--End Logo icon -->
                            <!-- Logo text --><span>
              
                                <!-- Light Logo text -->
                                <img src="/static/logo_name.png" class="light-logo" alt="homepage"></span>
                    </a>
                </div>
                <!-- ============================================================== -->
                <!-- End Logo -->
                <!-- ============================================================== -->
                
            </nav>
        </header>
 
        <aside class="left-sidebar">
            <!-- Sidebar scroll-->
            <div class="scroll-sidebar">
                <!-- User profile -->
                <div class="user-profile" style="background: url(https://www.wrappixel.com/demos/admin-templates/material-pro/assets/images/background/user-info.jpg) no-repeat;">
                    <!-- User profile image -->
                    <div class="profile-img"> <img src="https://upload.wikimedia.org/wikipedia/en/thumb/f/fa/COMSATS_Logo.svg/1200px-COMSATS_Logo.svg.png" alt="user"> </div>
                    <!-- User profile text-->
                    <div class="profile-text"> <a href="#" class="dropdown-toggle u-dropdown" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="true" ><span style="color: #f7b12c;">Comsats Lahore</span> </a>
                        <div class="dropdown-menu animated flipInY"> <a href="#" class="dropdown-item"><i class="ti-user"></i>
                                My Profile</a> <a href="#" class="dropdown-item"><i class="ti-wallet"></i> My
                                Balance</a>
                            <a href="#" class="dropdown-item"><i class="ti-email"></i> Inbox</a>
                            <div class="dropdown-divider"></div> <a href="#" class="dropdown-item"><i class="ti-settings"></i>
                                Account Setting</a>
                            <div class="dropdown-divider"></div> <a href="l" class="dropdown-item"><i class="fa fa-power-off"></i>
                                Logout</a>
                        </div>
                    </div>
                </div>
                <!-- End User profile text-->
                <!-- Sidebar navigation-->
                <nav class="sidebar-nav">
                    <ul id="sidebarnav">
                        <li class="nav-small-cap">Pentesting Phases</li>
                        <li> <a class="has-arrow waves-effect waves-light" href="{% url 'parsing:nm_scan_index' %}" ><i   class="mdi mdi-account-search active"></i><span class="hide-menu" >Scanning </span></a>
                            
                        </li>
                        <li> <a class="has-arrow waves-effect waves-light" href="{% url 'parsing:openvas_scan_index'  %}" ><i  class="mdi mdi-barcode-scan"></i><span class="hide-menu">Vul Scanning</span></a>
                           
                        </li>
                        <li> <a class="has-arrow waves-effect waves-dark"  href="#" ><i   class="mdi mdi-biohazard"></i><span class="hide-menu">Exploitation</span></a>
                           
                        </li>
                        <li> <a class="has-arrow waves-effect waves-dark" style="color: #f7b12c;" href="#" ><i  style="color: #f7b12c;"class="mdi mdi-laptop-windows"></i><span class="hide-menu">Sessions </span></a>
                            
                        </li>
                        <li> <a class="has-arrow waves-effect waves-dark" href="#" aria-expanded="false"><i class="mdi mdi-console"></i><span class="hide-menu">Shells</span></a>
                            
                        </li>
                        <li> <a class="has-arrow waves-effect waves-dark" href="#" aria-expanded="false"><i class="mdi mdi-file-document"></i><span class="hide-menu">Reports</span></a>
                            
                        </li>

                       
                        <li> <a class="has-arrow waves-effect waves-dark" href="#" aria-expanded="false"><i class="mdi mdi-widgets"></i><span class="hide-menu">Widgets<!--
                        </li-->
                        </span></a></li><li class="nav-devider"></li><a class="has-arrow waves-effect waves-dark" href="#" aria-expanded="false">
                        <li class="nav-small-cap">EXTRA COMPONENTS</li>

             
                        </a><li><a class="has-arrow waves-effect waves-dark" href="#" aria-expanded="false"><i class="mdi mdi-web"></i> Web Scanning</a><a class="has-arrow waves-effect waves-dark" href="#" aria-expanded="false"><i class="mdi mdi-wifi"></i><span class="hide-menu">Wlan0 Testing</span></a>
                           
                        </li>
            
                    </ul>
                </nav>
                <!-- End Sidebar navigation -->
            </div>
            <!-- End Sidebar scroll-->

            <!-- Bottom points-->
            <div class="sidebar-footer">
                <!-- item--><a href="#" class="link" data-toggle="tooldtip" title="Settings"><i class="ti-settings"></i></a>

                <!-- item--><a href="#" class="link" data-toggle="tooltidp" title="Email"><i class="mdi mdi-gmail"></i></a>

                <!-- item--><a href="#" class="link" data-toggle="tooltip" title="Logout"><i class="mdi mdi-power"></i></a>
            </div>
            <!-- End Bottom points-->
        </aside>

















































        <div class="page-wrapper">
            <!-- ============================================================== -->
            <!-- Container fluid  -->
            <!-- ============================================================== -->
            <div class="container-fluid" id="bck">
                <!-- ============================================================== -->
                <!-- Bread crumb and right sidebar toggle -->
                <!-- ============================================================== -->
                <div class="row page-titles">
                    <div class="col-md-5 col-12 align-self-center">
                        <h3 class="text-themecolor">RHOST Sessions </h3>
                        <ol class="breadcrumb">

                            <li class="breadcrumb-item active">Hone</li>
                            <li class="breadcrumb-item active">Scanning</li>
                            <li class="breadcrumb-item active">Vul Scanning</li>
                            <li class="breadcrumb-item active">Vul Report</li>
                            <li class="breadcrumb-item active">EXploit </li>
                            <li class="breadcrumb-item "><a href="javascript:void(0)">Sessions</a></li>
                        </ol>
                    </div>
                    <div class="col-md-7 col-12 align-self-center d-none d-md-block">
                        <div class="d-flex mt-2 justify-content-end">
                            <div class="d-flex mr-3 ml-2">
                                <div class="chart-text mr-2">
 
                                </div>
                                <div class="spark-chart">
                                    <div id="monthchart"></div>
                                </div>
                            </div>
                            <div class="d-flex mr-3 ml-2">
                                <div class="chart-text mr-2">
   
                                </div>
                                <div class="spark-chart">
                                    <div id="lastmonthchart"></div>
                                </div>
                            </div>
                            <div class="">

                            </div>
                        </div>
                    </div>
                </div>
                <!-- ============================================================== -->
                <!-- End Bread crumb and right sidebar toggle -->
                <!-- ============================================================== -->
                <!-- ============================================================== -->
                <!-- Start Page Content -->
                <!-- ============================================================== -->
                <!-- Row -->



{% if objerr != 'object not sound' %}
{% if flag  == 'exist' %}






















                <div class="row">
                    <!-- Column -->

                    <!-- Column -->
                    <div class="col-lg-4 col-md-12">
                        <div class="car d ca rd-inve rse car d-pri mary">
                            <div class="card-body" style="background: rgba(0, 0, 0, 0.6);">
                                <div class="d-flex">
                                    <div class="mr-3 align-self-center">
                                        <h1 class="text-white"><i class="ti-crown"></i></h1>
                                    </div>
                                    <div>
                                        <h3 class="card-title">Exploited RHOST Sessions </h3>
                                        <h6 class="card-subtitle">Phase 4</h6>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-10 align-self-center">

                                        <table class="table" >
                                            <th>
                                                <tr>
                                                    <th>Host Id</th>
                                                    <th>RHOST</th>
                                                    <th>SESSION </th>
                                                </tr>
                                            </th>
                                            <tbody>
                                                <tr>
                                                    <td>{{ host_id }}</td>
                                                    <td>{{ ip_addr }}</td>
                                                    <td>{{ flag }}</td>

                                                </tr>
                                            

                                            </tbody>
                                        </table>


  
                                    </div>
                                    <div class="col-2 pb-3 pt-2 align-self-center">
                                        <div class="usage chartist-chart" style="height:65px"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    
                  <div class="col-lg-4 col-md-12">
                        <div class="card">
                            <div class="card-body">
                                <h3 class="card-title">Terminal</h3>
                                <h6 class="card-subtitle">Terminal logs all the actions</h6>
                                <div id="visitor" style="height:100px; width:100%;">
                                        <textarea  id="session_terminal"  style="background-color: black; color: green;border: 1px solid orange; height:100%;width:100%; padding: 25px;">Xerror@W11 #:~> __</textarea>
                                </div>
                            </div>
                            <div class="card-body text-center border-top"></div>
                        </div>
 
                    </div>

                    <!-- Column -->
                    <div class="col-lg-4 col-md-12">
                        <div class="card card-inverse card-info">
                            <div class="card-body">
                                <div class="d-flex">
                                    <div class="mr-3 align-self-center">
                                        <h1 class="text-white"><i class="icon-cloud-download"></i></h1>
                                    </div>
                                    <div>
                                        <h3 class="card-title">Rhost Request Status</h3>
                                        <h4 class="card-subtitle"> Notifications </h4>
                                    </div>
                                </div>
                                <div class="row">
                                    
                                        <h4 class="font-weight-light text-white text-nowrap text-truncate">
                                            
                                            <ul id="notification_session" style="color: black;">
                                             </ul>
                                        </h4>

                                    <div class="col-4 align-self-center">
                                    </div>
                                    <div class="col-8 pb-3 pt-2 text-right">
                                        <div class="spark-count" style="height:65px"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    <!-- </div> -->
                    <!-- Column -->



<!-- 
<div class="col-lg-4 col-md-12">
                        <div class="card">
                            <div class="card-body">
                                <h3 class="card-title">Terminal</h3>
                                <h6 class="card-subtitle">Terminal logs all the actions</h6>
                                <div id="visitor" style="height:290px; width:100%;">
                                        <textarea  id="session_terminal"  style="background-color: black; color: green; height:100%;width:100%; padding: 25px;">Xerror@W11 #:~> __</textarea>
                                </div>
                            </div>
                            <div class="card-body text-center border-top"></div>
                        </div>
                    </div> -->
                    <!-- Column -->
                    
                    <!-- Column -->
                </div>


 





                <div class="row">
                    <!-- Column -->
                    
                    <div class="col-lg-12 col-md-12">
                        <div class="card-body card">
                            <div class="">
                                <div class="d-flex flex-wrap">









































                                    <div>
                                        <h3 class="card-title">Exploited RHOST Sessioned Details </h3>
                                        <h6 class="card-subtitle">Verify/interact with session </h6>
                                    </div>
                                    <div class="ml-auto align-self-center">
                                        <ul class="list-inline mb-0">
                                            <li class="list-inline-item px-2">
                                                <h6 class="text-success"><i class="fa fa-circle font-10 mr-2 "></i>Alive session </h6>
                                            </li>
                                            <li class="list-inline-item px-2">
                                                <h6 class="text-info"><i class="fa fa-circle font-10 mr-2"></i> Deaad session   </h6>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="card-body ">



<table class="table">
      <thead class="thead-dark">
         <tr>
                  <th>Host Id</th>
                  <th>RHOST</th>
                  <th>RPORT </th>
                  <th>CVE number</th>
                  <th>Exploit_Name</th>
                  <th>Payload Name</th>
                  <th>Exploit Status</th>
                  <th>Sessoin Id </th>
                  <th>Exploit UUID</th>
                  <th>Session Type</th>
                  <th>Tunnel Peer</th>
                  <th>Session Status</th>
                  <th> Actoin </th>
                </tr>
      <tbody>
       {% for k,v in sessions.items %}
                  <tr>
                      <td>{{v.host_id}}</td>
                      <td>{{v.host_name}}</td>
                      <td>{{v.rport}}</td>
                      <td>{{v.cve}}</td>
                      <td>{{v.exploit_name}}</td>
                      <td>{{v.payload_name}}</td>
                      <td>{{v.exploited}}</td>
                      <td>{{v.session_id}}</td>
                      <td>{{v.exploit_uuid}}</td>
                      <td>{{v.session_type}}</td>
                      <td>{{v.tunnel_peer}}</td>

                          <!-- {% for i,j in v.items %}
                              <td>{{j}}</td>
                            {% endfor %} -->
                    <td> 
                        {% if v.session_id  == 'no' %}
                                <button type="button"  class="btn btn-outline-warning">
                                            Session <br>  <br> 
                                            <span id="session-status-{{v.session_id}}" class="badge badge-warning disabled" style="  color: currentColor;  cursor: not-allowed;  opacity: 0.5;  text-decoration: none; background: rgba(0, 0, 0, 0.15); border: 1px solid orange; padding: 5px; color: orange; margin: 2px;">  Retired
                                            </span>
                                 </button> 
                          {% else %}

                              <button type="button"  value='{{v.session_id}}?{{host_id}}?{{v.exploit_uuid}}' 
                                onClick="session_status_btn_clicked(this.value)"  class="btn btn-outline-warning">
                                Session <br>  <br> 
                                <span id="session-status-{{v.session_id}}" class="badge badge-warning" style=" background: rgba(0, 0, 0, 0.15); border: 1px solid orange; padding: 5px; color: orange; margin: 2px;">?
                                </span>
                              </button> 

                          {% endif %}

                    </td>

                    <td>

                      {% if v.session_id  == 'no' %}
                            <center>

                                 <a  class="btn btn-outline-danger " role="button" style="margin-top: 20px;  color: currentColor;  cursor: not-allowed;  opacity: 0.5;  text-decoration: none;"> Interact </a></center>
                          {% else %}

                                      <a href="{% url 'parsing:msf_session_intract' v.session_id host_id v.exploit_uuid %}" style="margin-top: 20px;" class="btn btn-outline-danger " role="button"> Interact </a>
                          {% endif %}




                          
                    </td>
                  </tr>
                {% endfor %}
      </tbody>
  </table>


                                    











                                 </div>
                                
                            </div>
                        </div>
                    </div>
                </div>





           <div class="row">
                    <!-- Column -->
                    
                    <div class="col-lg-4 col-md-12">
                        <div class="card">
                            <div class="card-body">
                                <h3 class="card-title">Terminal</h3>
                                <h6 class="card-subtitle">Terminal logs all the actions</h6>
                                <div id="visitor" style="height:290px; width:100%;">
                                        <textarea  id="session_terminal"  style="background-color: black; color: green; height:100%;width:100%; padding: 25px;">Xerror@W11 #:~> __</textarea>
                                </div>
                            </div>
                            <div class="card-body text-center border-top"></div>
                        </div>
                    </div>
             </div>
                <!-- Row -->
                <!-- Row -->
{% else %}



                    <div class="col-lg-12 col-md-12">
                        <div class="card-body card">
                            <div class="">
                                <div class="d-flex flex-wrap">
                            

                                    <h1> <center> Requested object session does not exist  </center> </h1>
                                        <br><br><br><br><br><br><br><br>
                                </div>
                            </div>
                        </div>
                    </div>
{% endif %}

{% else %}
                    <div class="col-lg-12 col-md-12">
                        <div class="card-body card">
                            <div class="">
                                <div class="d-flex flex-wrap">
                            

                                    <h1> <center> Requested object not found </center> </h1>
                                        <br><br><br><br><br><br><br><br>
                                </div>
                            </div>
                        </div>
                    </div>

{% endif %}

 <div class="row">
                    <!-- Column -->
                    
                <!-- Row -->
                
                <!-- Row -->
                <!-- Row -->
                
                <!-- ============================================================== -->
                <!-- End PAge Content -->
                <!-- ============================================================== -->
                <!-- ============================================================== -->
                <!-- Right sidebar -->
                <!-- ============================================================== -->
                <!-- .right-sidebar -->
                
                <!-- ============================================================== -->
                <!-- End Right sidebar -->
                <!-- ============================================================== -->
            </div>
            <!-- ============================================================== -->
            <!-- End Container fluid  -->
            <!-- ============================================================== -->
            <!-- ============================================================== -->
            <!-- footer -->
            <!-- ============================================================== -->
            <footer class="footer">
                © 2020 Xerror Pentest tool  by Xerror Tech Sol's
            </footer>
            <!-- ============================================================== -->
            <!-- End footer -->
            <!-- ============================================================== -->
        </div>
        <!-- ============================================================== -->
        <!-- End Page wrapper  -->
        <!-- ============================================================== -->
    </div>



<!-- Mirrored from www.wrappixel.com/demos/admin-templates/material-pro/dark/index.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 06 May 2020 12:28:49 GMT -->


<!-- Mirrored from www.wrappixel.com/demos/admin-templates/material-pro/dark/index.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 06 May 2020 12:28:49 GMT -->





<script type="text/javascript">
  


  function session_status_btn_clicked(clicked_id)
  {

        $.ajax({
            
            method:'POST',
            url: '/msf_session_status_check_ajax/',
            data: clicked_id,

            success: handleSuccess,
            error: handleError,
        });
        function handleSuccess(data){
            // alert(data.msg)

         // var node = document.createElement("LI");
         //    var textnode = document.createTextNode(data.msg);
         //    node.appendChild(textnode);
         //    document.getElementById("notification_session").appendChild(node); 



            console.log(data.msg);
        }
        function handleError(ThrowError){
            console.log(ThrowError);
        }

      // alert(clicked_id);
               var node = document.createElement("LI");
            var textnode = document.createTextNode("sending session status req ");
            node.appendChild(textnode);
            document.getElementById("notification_session").appendChild(node); 

  }//end session status check 


  function sessioninteract_btn_clicked(clicked_id)
  {
      alert(clicked_id);

        $.ajax({
            
            method:'POST',
            url: '/msf_exploisdfsdfft_ajx/',
            data: clicked_id,

            success: handleSuccess,
            error: handleError,
        });
        function handleSuccess(data){
            alert(data.msg)

         var node = document.createElement("LI");
            var textnode = document.createTextNode(data.msg);
            node.appendChild(textnode);
            document.getElementById("notification_session").appendChild(node); 


            console.log(data.msg);
            $myForm[0].reset()
        }
        function handleError(ThrowError){
            console.log(ThrowError);
        }

  }//end session interact 





</script>


<script>
// For production move script to separate *.js file and include here
$(function() {




    // When we're using HTTPS, use WSS too.
    var ws_scheme = window.location.protocol == "https:" ? "wss" : "ws";
    var ws_path = ws_scheme + '://' + window.location.host + '/pool/';
    console.log("Connecting to " + ws_path)

    var socket = new ReconnectingWebSocket(ws_path);
    socket.onmessage = function(message) {
      // Catch websocket messages
        console.log("Got message: " + message.data);

        var data = JSON.parse(message.data);
        if (data.action == "uploaded"){
          // After uploading file change table id's to real file id
                $('input[type=file]').val('')
                var item = $('#process-' + data.file_id);
                $('#file-' + data.file_id).text(data.new_file_id)
                $('#file-' + data.file_id).attr("id", "file-" + data.new_file_id);
                $('#process-' + data.file_id).attr("id", "process-" + data.new_file_id);
                $('#result-' + data.file_id).attr("id", "result-" + data.new_file_id);

            // alert(data.file_id)


        }

      


        else if (data.action == "session_status_checking"){
          // Draw celery task progress
            document.getElementById("session_terminal").value +=data.session_current_status;

            $('#session_terminal').scrollTop($('#session_terminal')[0].scrollHeight);
            
              if ( data.session_status == "active" ){
                var item = $('#session-status-' + data.session_id );
                item.attr("class", "badge badge-success");
                 item.text(data.session_status);

                var node = document.createElement("LI");
                var textnode = document.createTextNode(data.session_status);
                node.appendChild(textnode);
                document.getElementById("notification_session").appendChild(node); 

               } 
               else if( data.session_status == "no" ){
                var item = $('#session-status-' + data.session_id );
                item.attr("class", "badge badge-danger");
                 item.text(data.session_status);
              var node = document.createElement("LI");
                var textnode = document.createTextNode(data.session_status);
                node.appendChild(textnode);
                document.getElementById("notification_session").appendChild(node); 


               }else{

                var item = $('#session-status-' + data.session_id );
                item.attr("class", "badge badge-info");
                 item.text(data.session_status);

                 var node = document.createElement("LI");
                var textnode = document.createTextNode(data.session_status);
                node.appendChild(textnode);
                document.getElementById("notification_session").appendChild(node); 


               }

        }
































    };//end of onmessage

});//end of main funciton  

</script>
</body>
</html>


